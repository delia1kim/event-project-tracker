<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Project Tracker</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .current-date {
            font-size: 14px;
            margin-top: 5px;
            opacity: 0.9;
        }
        .summary-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.2s ease;
        }
        .summary-card:hover {
            transform: translateY(-2px);
        }
        .summary-card.urgent {
            border-left: 5px solid #dc3545;
        }
        .summary-card.today {
            border-left: 5px solid #ffc107;
        }
        .summary-card.upcoming {
            border-left: 5px solid #28a745;
        }
        .summary-number {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
            animation: countUp 1s ease-out;
        }
        .urgent .summary-number { color: #dc3545; }
        .today .summary-number { color: #ffc107; }
        .upcoming .summary-number { color: #28a745; }
        
        @keyframes countUp {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .view-controls {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            text-align: center;
        }
        .view-controls button {
            padding: 10px 20px;
            margin: 0 5px;
            border: 2px solid #3498db;
            background: white;
            color: #3498db;
            cursor: pointer;
            border-radius: 25px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .view-controls button:hover {
            background: #3498db;
            color: white;
            transform: translateY(-1px);
        }
        .view-controls button.active {
            background: #3498db;
            color: white;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }
        .main-tracker {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .table-container {
            overflow-x: auto;
            max-height: 800px;
            overflow-y: auto;
        }
        .tracker-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 10px;
            font-family: 'Calibri', sans-serif;
        }
        .tracker-table th {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 12px 8px;
            text-align: center;
            font-weight: bold;
            border: 1px solid #34495e;
            position: sticky;
            top: 0;
            z-index: 10;
            font-size: 9px;
        }
        .tracker-table td {
            padding: 8px 6px;
            border: 1px solid #dee2e6;
            text-align: center;
            vertical-align: middle;
            font-size: 9px;
            transition: background-color 0.2s ease;
        }
        .tracker-table tr:hover {
            background-color: #f8f9fa;
        }
        .tracker-table tr.past-event {
            opacity: 0.6;
            background-color: #f8f9fa;
        }
        .tracker-table tr.today-event {
            background-color: #fff3cd;
            font-weight: bold;
        }
        .tracker-table tr.needs-attention {
            background-color: #ffeaa7;
            border-left: 4px solid #fdcb6e;
        }
        .event-info {
            text-align: left;
            font-weight: bold;
            min-width: 100px;
        }
        .milestone-cell {
            min-width: 80px;
            padding: 4px;
        }
        .status-indicator {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            text-align: center;
            line-height: 20px;
            font-size: 10px;
            margin: 2px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            font-weight: bold;
        }
        .status-indicator:hover {
            transform: scale(1.2);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .status-indicator:active {
            transform: scale(0.9);
        }
        .done { 
            background: linear-gradient(135deg, #28a745, #20c997); 
            color: white; 
            border-color: #28a745;
        }
        .pending { 
            background: linear-gradient(135deg, #ffc107, #ffeb3b); 
            color: #212529; 
            border-color: #ffc107;
            animation: pulse 2s infinite;
        }
        .overdue { 
            background: linear-gradient(135deg, #dc3545, #e74c3c); 
            color: white; 
            border-color: #dc3545;
            animation: shake 0.5s ease-in-out infinite alternate;
        }
        .not-due { 
            background: linear-gradient(135deg, #6c757d, #95a5a6); 
            color: white; 
            border-color: #6c757d;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 193, 7, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 193, 7, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 193, 7, 0); }
        }
        
        @keyframes shake {
            0% { transform: translateX(0); }
            100% { transform: translateX(2px); }
        }
        
        .metric-box {
            background: #f8f9fa;
            padding: 2px 4px;
            border-radius: 3px;
            margin: 1px;
            font-size: 8px;
            border: 1px solid #e9ecef;
        }
        .person-tag {
            background: #e3f2fd;
            padding: 2px 6px;
            border-radius: 12px;
            font-size: 7px;
            margin: 1px;
            display: inline-block;
            color: #1976d2;
            font-weight: 500;
        }
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin: 3px 0;
            position: relative;
        }
        .progress-fill {
            height: 100%;
            transition: width 0.5s ease;
            position: relative;
        }
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .progress-good { background: linear-gradient(90deg, #28a745, #20c997); }
        .progress-warning { background: linear-gradient(90deg, #ffc107, #ffeb3b); }
        .progress-danger { background: linear-gradient(90deg, #dc3545, #e74c3c); }
        
        .task-completed {
            opacity: 0.7;
            background-color: #d4edda !important;
        }
        
        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 1000;
            text-align: center;
            display: none;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .filter-section {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .filter-section select {
            padding: 8px 15px;
            border: 2px solid #3498db;
            border-radius: 20px;
            background: white;
            color: #3498db;
            font-weight: 500;
        }
        
        .legend {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        
        .legend-item {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin: 5px 15px 5px 0;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ðŸ“‹ Event Project Tracker</h1>
        <div class="current-date" id="current-date"></div>
        <div style="font-size: 12px; margin-top: 8px; opacity: 0.9;">
            Click status indicators to update â€¢ Real-time progress tracking â€¢ Event coordination
        </div>
    </div>

    <div class="summary-section">
        <div class="summary-card urgent">
            <div class="summary-number" id="overdue-count">8</div>
            <div>Overdue Tasks</div>
        </div>
        <div class="summary-card today">
            <div class="summary-number" id="today-count">5</div>
            <div>Due Today</div>
        </div>
        <div class="summary-card upcoming">
            <div class="summary-number" id="week-count">12</div>
            <div>Due This Week</div>
        </div>
        <div class="summary-card">
            <div class="summary-number" id="progress-percent">73%</div>
            <div>Overall Progress</div>
        </div>
    </div>

    <div class="filter-section">
        <label style="font-weight: bold;">Filter by Person:</label>
        <select id="person-filter" onchange="filterByPerson()">
            <option value="all">All Team Members</option>
            <option value="seray">Seray</option>
            <option value="maria">Maria</option>
            <option value="manuel">Manuel</option>
            <option value="delia">Delia</option>
            <option value="andreea">Andreea</option>
        </select>
        
        <label style="font-weight: bold; margin-left: 20px;">Show:</label>
        <select id="status-filter" onchange="filterByStatus()">
            <option value="all">All Events</option>
            <option value="urgent">Urgent Only</option>
            <option value="due-today">Due Today</option>
            <option value="upcoming">Upcoming</option>
            <option value="on-track">On Track</option>
        </select>
    </div>

    <div class="view-controls">
        <button class="active" onclick="showView('all')">All Events</button>
        <button onclick="showView('urgent')">Urgent Tasks</button>
        <button onclick="showView('upcoming')">Due Soon</button>
        <button onclick="showView('completed')">Completed</button>
    </div>

    <div class="main-tracker">
        <div class="table-container">
            <table class="tracker-table">
                <thead>
                    <tr>
                        <th rowspan="2">Event Info</th>
                        <th rowspan="2">Event Setup</th>
                        <th colspan="3">E-45 Tasks (45 days before)</th>
                        <th>E-30</th>
                        <th>E-14</th>
                        <th>E-1</th>
                        <th rowspan="2">Booking Performance</th>
                        <th rowspan="2">Overall Progress</th>
                    </tr>
                    <tr>
                        <th>School Reqs</th>
                        <th>Slots Open</th>
                        <th>Automatch On</th>
                        <th>Manual Selection</th>
                        <th>Manual Invites</th>
                        <th>Final Prep</th>
                    </tr>
                </thead>
                <tbody id="tracker-tbody">
                    <!-- Populated by JavaScript -->
                </tbody>
            </table>
        </div>
    </div>

    <div class="legend">
        <h4>ðŸŽ¯ How to Use the Event Project Tracker:</h4>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; font-size: 12px;">
            <div>
                <strong>Status Indicators (Click to Change):</strong>
                <div class="legend-item">
                    <div class="status-indicator done">âœ“</div> Task Complete
                </div>
                <div class="legend-item">
                    <div class="status-indicator pending">!</div> Due Today/Pending
                </div>
                <div class="legend-item">
                    <div class="status-indicator overdue">âœ—</div> Overdue (Urgent!)
                </div>
                <div class="legend-item">
                    <div class="status-indicator not-due">-</div> Not Due Yet
                </div>
            </div>
            <div>
                <strong>Features:</strong>
                <ul style="margin: 5px 0; padding-left: 20px;">
                    <li>Click any status indicator to cycle through states</li>
                    <li>Filter by person or status using dropdowns</li>
                    <li>Progress bars update automatically</li>
                    <li>Hover effects and animations for better UX</li>
                    <li>Data persists in your browser session</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="celebration" id="celebration">
        <h2>ðŸŽ‰ Great Job!</h2>
        <p>Task completed successfully!</p>
        <button onclick="closeCelebration()" style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer;">Continue</button>
    </div>

    <div class="notification" id="notification">
        <span id="notification-text">Task updated!</span>
    </div>

    <script>
        // Sample event data with detailed milestone tracking
        let eventData = [
            {
                id: 'E001',
                date: '2025-08-30',
                event: 'Mexico City CMBA',
                city: 'Mexico City',
                schools: 24,
                target: 120,
                actual: 87,
                team: ['Seray', 'Manuel'],
                status: 'complete',
                milestones: {
                    schoolReqs: { person: 'Seray, Manuel', status: 'done', date: '2025-07-16' },
                    slotsOpen: { person: 'Seray, Manuel', status: 'done', date: '2025-07-17' },
                    automatch: { person: 'Seray, Manuel', status: 'done', date: '2025-07-18' },
                    selection: { person: 'Seray, Manuel', status: 'done', date: '2025-07-31' },
                    invites: { person: 'Seray, Manuel', status: 'done', date: '2025-08-16' },
                    finalPrep: { person: 'Seray, Manuel', status: 'done', date: '2025-08-29' }
                }
            },
            {
                id: 'E002',
                date: '2025-09-01',
                event: 'Bogota CM',
                city: 'Bogota',
                schools: 16,
                target: 80,
                actual: 23,
                team: ['Delia', 'Maria'],
                status: 'behind',
                milestones: {
                    schoolReqs: { person: 'Delia', status: 'overdue', due: '2025-07-17', daysLate: 8 },
                    slotsOpen: { person: 'Delia', status: 'overdue', due: '2025-07-17', daysLate: 8 },
                    automatch: { person: 'Delia', status: 'overdue', due: '2025-07-17', daysLate: 8 },
                    selection: { person: 'Delia', status: 'overdue', due: '2025-08-02', daysLate: 30 },
                    invites: { person: 'Maria', status: 'pending', due: '2025-08-18' },
                    finalPrep: { person: 'Delia', status: 'not-due', due: '2025-08-31' }
                }
            },
            {
                id: 'E003',
                date: '2025-09-06',
                event: 'Lima CMBA',
                city: 'Lima',
                schools: 18,
                target: 90,
                actual: 45,
                team: ['Seray', 'Maria'],
                status: 'behind',
                milestones: {
                    schoolReqs: { person: 'Seray', status: 'overdue', due: '2025-07-23', daysLate: 3 },
                    slotsOpen: { person: 'Seray', status: 'overdue', due: '2025-07-23', daysLate: 3 },
                    automatch: { person: 'Seray', status: 'overdue', due: '2025-07-23', daysLate: 3 },
                    selection: { person: 'Seray', status: 'overdue', due: '2025-08-07', daysLate: 25 },
                    invites: { person: 'Maria', status: 'pending', due: '2025-08-23' },
                    finalPrep: { person: 'Seray', status: 'not-due', due: '2025-09-05' }
                }
            },
            {
                id: 'E004',
                date: '2025-09-13',
                event: 'NYC CMBA',
                city: 'New York City',
                schools: 30,
                target: 150,
                actual: 95,
                team: ['Seray', 'Manuel'],
                status: 'active',
                milestones: {
                    schoolReqs: { person: 'Seray', status: 'overdue', due: '2025-07-30', daysLate: 1 },
                    slotsOpen: { person: 'Seray', status: 'overdue', due: '2025-07-30', daysLate: 1 },
                    automatch: { person: 'Seray', status: 'overdue', due: '2025-07-30', daysLate: 1 },
                    selection: { person: 'Seray', status: 'overdue', due: '2025-08-14', daysLate: 18 },
                    invites: { person: 'Manuel', status: 'pending', due: '2025-08-30', dueToday: true },
                    finalPrep: { person: 'Seray', status: 'not-due', due: '2025-09-12' }
                }
            },
            {
                id: 'E005',
                date: '2025-10-14',
                event: 'Stockholm CMBA+',
                city: 'Stockholm',
                schools: 32,
                target: 160,
                actual: 0,
                team: ['Andreea', 'Maria'],
                status: 'pending',
                milestones: {
                    schoolReqs: { person: 'Andreea', status: 'pending', due: '2025-08-30', dueToday: true },
                    slotsOpen: { person: 'Andreea', status: 'pending', due: '2025-08-30', dueToday: true },
                    automatch: { person: 'Andreea', status: 'pending', due: '2025-08-30', dueToday: true },
                    selection: { person: 'Andreea', status: 'not-due', due: '2025-09-14' },
                    invites: { person: 'Maria', status: 'not-due', due: '2025-09-30' },
                    finalPrep: { person: 'Andreea', status: 'not-due', due: '2025-10-13' }
                }
            }
        ];

        let currentFilter = { person: 'all', status: 'all' };

        // Initialize the app
        function initializeApp() {
            // Set current date
            document.getElementById('current-date').textContent = 
                'Today: ' + new Date().toLocaleDateString('en-US', { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });

            updateTable();
            updateSummaryStats();
        }

        // Update the main tracker table
        function updateTable() {
            const tbody = document.getElementById('tracker-tbody');
            tbody.innerHTML = '';

            const filteredData = getFilteredData();

            filteredData.forEach(event => {
                const row = document.createElement('tr');
                
                // Determine row class based on status
                if (event.status === 'complete') {
                    row.className = 'past-event';
                } else if (event.status === 'behind') {
                    row.className = 'needs-attention';
                } else if (event.date === getCurrentDateString()) {
                    row.className = 'today-event';
                }

                const progressPercent = Math.round((event.actual / event.target) * 100);
                const progressClass = progressPercent >= 80 ? 'progress-good' : 
                                    progressPercent >= 50 ? 'progress-warning' : 'progress-danger';

                // Calculate overall task progress
                const milestones = Object.values(event.milestones);
                const completedTasks = milestones.filter(m => m.status === 'done').length;
                const taskProgressPercent = Math.round((completedTasks / milestones.length) * 100);

                row.innerHTML = `
                    <td class="event-info">
                        <div style="font-weight: bold;">${formatDate(event.date)}</div>
                        <div style="font-size: 8px; color: #666;">${event.event}</div>
                        ${event.team.map(person => `<div class="person-tag">${person}</div>`).join('')}
                    </td>
                    <td class="milestone-cell">
                        <div class="metric-box"><strong>Schools:</strong> ${event.schools}</div>
                        <div class="metric-box"><strong>Target:</strong> ${event.target}</div>
                        <div class="metric-box"><strong>Actual:</strong> ${event.actual}</div>
                    </td>
                    ${renderMilestone(event, 'schoolReqs')}
                    ${renderMilestone(event, 'slotsOpen')}
                    ${renderMilestone(event, 'automatch')}
                    ${renderMilestone(event, 'selection')}
                    ${renderMilestone(event, 'invites')}
                    ${renderMilestone(event, 'finalPrep')}
                    <td class="milestone-cell">
                        <div class="progress-bar">
                            <div class="progress-fill ${progressClass}" style="width: ${progressPercent}%;"></div>
                        </div>
                        <div style="font-size: 8px;">${event.actual}/${event.target} bookings</div>
                        ${progressPercent < 80 ? `<div style="font-size: 7px; color: #dc3545;">${event.target - event.actual} behind target</div>` : ''}
                    </td>
                    <td>
                        <div class="progress-bar">
                            <div class="progress-fill ${taskProgressPercent === 100 ? 'progress-good' : taskProgressPercent >= 50 ? 'progress-warning' : 'progress-danger'}" 
                                 style="width: ${taskProgressPercent}%;"></div>
                        </div>
                        <div style="font-size: 8px;">${completedTasks}/${milestones.length} Complete</div>
                        <div style="font-size: 8px;">${taskProgressPercent}%</div>
                    </td>
                `;

                tbody.appendChild(row);
            });
        }

        function renderMilestone(event, milestoneKey) {
            const milestone = event.milestones[milestoneKey];
            const statusIcon = getStatusIcon(milestone.status);
            
            return `
                <td class="milestone-cell">
                    <div class="status-indicator ${milestone.status}" 
                         onclick="toggleMilestoneStatus('${event.id}', '${milestoneKey}')"
                         title="Click to change status">
                        ${statusIcon}
                    </div>
                    <div class="metric-box">${milestone.person}</div>
                    ${milestone.date ? `<div class="metric-box">${formatDate(milestone.date)}</div>` : ''}
                    ${milestone.daysLate ? `<div class="metric-box" style="color: red;">${milestone.daysLate} days late</div>` : ''}
                    ${milestone.dueToday ? `<div class="metric-box" style="color: orange; font-weight: bold;">DUE TODAY</div>` : ''}
                </td>
            `;
        }

        function getStatusIcon(status) {
            switch(status) {
                case 'done': return 'âœ“';
                case 'pending': return '!';
                case 'overdue': return 'âœ—';
                case 'not-due': return '-';
                default: return '?';
            }
        }

        function toggleMilestoneStatus(eventId, milestoneKey) {
            const event = eventData.find(e => e.id === eventId);
            const milestone = event.milestones[milestoneKey];
            
            // Cycle through statuses: done â†’ pending â†’ overdue â†’ not-due â†’ done
            const statusCycle = ['done', 'pending', 'overdue', 'not-due'];
            const currentIndex = statusCycle.indexOf(milestone.status);
            const nextIndex = (currentIndex + 1) % statusCycle.length;
            
            milestone.status = statusCycle[nextIndex];
            
            // Add completion date if marked as done
            if (milestone.status === 'done') {
                milestone.date = getCurrentDateString();
                showCelebration();
            }
            
            // Update display
            updateTable();
            updateSummaryStats();
